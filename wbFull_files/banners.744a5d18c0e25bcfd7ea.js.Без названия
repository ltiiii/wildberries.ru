(()=>{"use strict";function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}const e=function(e){function n(t){var n;return(n=e.call(this)||this).func=t.func,n.interval=t.interval,n.timerObj=null,n}var i,s;s=e,(i=n).prototype=Object.create(s.prototype),i.prototype.constructor=i,t(i,s);var a=n.prototype;return a.stop=function(){return this.timerObj&&(clearInterval(this.timerObj),this.timerObj=null),this},a.start=function(){return this.timerObj||(this.stop(),this.timerObj=setInterval(this.func,this.interval)),this},n}(WbSpaModel);const n=function(){function t(t){this.el=null,this.pic=null,this.data=null,this.timer=null,this._bindEvents()}var n=t.prototype;return n.start=function(t){return this.timer&&(this.timer.stop(),this.timer=null),this.imgs=t.querySelectorAll(".j-banners-carousel-item").toArray(),this.imgs.length>1&&(this.timer=new e({func:this.updateImage.bind(this),interval:4e3}),this.el=t,this.currentImg=t.querySelector(".j-banners-carousel-item.active"),null==this.currentImg?(this.currentImgIdx=0,this.imgs[this.currentImgIdx].classList.add("active")):this.currentImgIdx=this.imgs.indexOf(this.currentImg),this.timer.start()),this},n.stop=function(){var t;null===(t=this.timer)||void 0===t||t.stop(),this.timer=null},n.updateImage=function(){let t=this.currentImgIdx+1;t>=this.imgs.length&&(t=0);const e=this.imgs[t];if(this.currentImg.classList.remove("active"),e.classList.add("active"),this.currentImg=e,this.currentImgIdx=t,"d"===wb.settings.displayMode){const t=document.querySelector(".j-tooltip-advertising");t&&t.elemTarget.closest(".j-slider-banners")&&t.close()}},n._bindEvents=function(){window.addEventListener("spaTransition",(()=>this.stop()))},t}();$.views.tags({bigBanners:{template:'{^{if ~tag.bannersList.length > 0}}\n                <div class="swiper-container j-main-banners{{if !~tagCtx.props.isAdaptive}} big-banner-inner{{/if}}">\n                    <div class="swiper-wrapper{{if !~tagCtx.props.isAdaptive}} big-banner{{/if}}">\n                        {^{for ~tag.bannersList}}\n                            {{singleBanner banner=#data itemClass=\'swiper-slide\' imgClass="swiper-lazy" isLazy=(#getIndex() > 0)\n                                swiperLazyLoad=true  protectAdult=~tagCtx.props.protectAdult \n                                imgContClass=~tagCtx.props.imgContClass bannersZoneClass=~tagCtx.props.bannersZoneClass\n                                bannersZonesContainer=~tagCtx.props.bannersZonesContainer\n                                bannerIndex=#getIndex() analiticsCode=~tagCtx.props.analiticsCode\n                                width=~tag.width height=~tag.height\n                            /}}\n                        {{/for}}\n                    </div>\n                    <button class="swiper-button-prev{{if ~tag.bannersList.length <= 1}} hide{{/if}}" type="button">Назад</button>\n                    <button class="swiper-button-next{{if ~tag.bannersList.length <= 1}} hide{{/if}}" type="button">Вперёд</button>\n                    <div class="swiper-pagination{{if ~tag.bannersList.length <= 1}} hide{{/if}}"></div>\n                </div>\n            {{/if}}',init(){this.bannersList=[],this.swiper=null,this.width=this.tagCtx.props.width||!1,this.height=this.tagCtx.props.height||!1},onUpdate:!1,async onAfterLink(){var t,e;const n=this;null===(t=this.swiper)||void 0===t||t.destroy(),null===(e=this.observer)||void 0===e||e.destroy(),this._prepareBannersList();const i=this.linkCtx.elem.querySelector(".j-main-banners");function s(){var t;const e=null===(t=n.swiper.slides)||void 0===t?void 0:t[n.swiper.activeIndex];if(!e||e.classList.contains("swiper-slide-duplicate"))return;const i=e.querySelector(".j-banner");if(i.dataset.wbaShownStatSent)return;const{data:s}=$.view(i),a=!!s.ordBannerMark;i.dataset.wbaShownStatSent=!0,n.ctx.root.$stat.banners.sendShownStatistic(i),n.ctx.root.$analitic.sendBannersWbaEvent("Banner_S",i.title,i.dataset.analiticsCode,i.href,i.dataset.bannerIndex,i.dataset.bannerId,a,s.pixelSrc)}function a(t){n.swiper.on("slideChange",s),s(),n.swiper.autoplay.start()}function r(t){n.swiper.off("slideChange",s),n.swiper.autoplay.stop()}null!=i?(await this.ctx.root.$helper.nextTick(),this.swiper=new Swiper(i,{spaceBetween:8,loop:this.bannersList.length>1,preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!0},autoplay:{delay:1e4},pagination:{el:i.querySelector(".swiper-pagination"),renderBullet:(t,e)=>`<button role="button" type="button" aria-label="Dot slide" class="${e}"></button>`,clickable:!0},navigation:{nextEl:i.querySelector(".swiper-button-next"),prevEl:i.querySelector(".swiper-button-prev"),disabledClass:"hide"},on:{init:()=>{var t,e;null===(e=null===(t=this.tagCtx.props.bigBannersCallbacks)||void 0===t?void 0:t.onInit)||void 0===e||e.call(t)},click:t=>{var e,n;null===(n=null===(e=this.tagCtx.props.bigBannersCallbacks)||void 0===e?void 0:e.onClick)||void 0===n||n.call(e,t);const i=t.target.closest(".j-banner-click-stat");if(null!=i){const{data:t}=$.view(i);this.ctx.root.$stat.banners.sendClickStatistic($(i)),this.ctx.root.$analitic.saveState({l:this.tagCtx.props.analiticsCode,t:null==t?void 0:t.id,t2:parseInt(i.dataset.bannerIndex)+1})}}}}),this.swiper.on("transitionStart",(()=>{let t=this.swiper.$wrapperEl,e=this.swiper.params;if(t.children("."+e.slideClass+"."+e.slideDuplicateClass).each((function(){let n=this.getAttribute("data-swiper-slide-index");this.innerHTML=t.children("."+e.slideClass+'[data-swiper-slide-index="'+n+'"]:not(.'+e.slideDuplicateClass+")").html()})),"d"===wb.settings.displayMode){const t=document.querySelector(".j-tooltip-advertising");t&&t.elemTarget.closest(".j-main-banners")&&t.close()}})),this.swiper.on("transitionEnd",(()=>{this.swiper.slideToLoop(this.swiper.realIndex,0,!1)})),this.observer=function(){var t;const e=navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.indexOf("Trident/")>0;let s;e?a():(s=null===(t=n.ctx.root)||void 0===t?void 0:t.$observerHelper.getCarouselBannersObserver(i,{threshold:.5}),i.addEventListener(s.elementInViewportEventName,a),i.addEventListener(s.elementOutOfViewportEventName,r),s.observe());return{destroy:function(){!e&&s&&(s.destroy(),i.removeEventListener(s.elementInViewportEventName,a),i.removeEventListener(s.elementOutOfViewportEventName,r))}}}()):this.swiper=null},onDispose(){var t,e;null===(t=this.swiper)||void 0===t||t.destroy(),null===(e=this.observer)||void 0===e||e.destroy()},_prepareBannersList(){var t;const e=null!==(t=this.tagCtx.props.bannersList)&&void 0!==t?t:[];$.observable(this.bannersList).refresh(e)}},bannersCarousel:{template:'<div class="swiper-container j-single-banner">\n                <div class="swiper-wrapper">\n                    {{for ~tag.banners}}\n                    <div class="swiper-slide">\n                        {{singleBanner banner=#data bannerIndex=#getIndex() analiticsCode=~tag.analiticsCode itemClass=\'swiper-img\' width=~tag.width height=~tag.height /}}\n                    </div>\n                    {{/for}}\n                </div>\n            </div>\n            <button class="swiper-button-prev" type="button" aria-label="Назад"></button>\n            <button class="swiper-button-next" type="button" aria-label="Вперёд"></button>',init(){var t;this.banners=null!==(t=this.tagCtx.props.banners)&&void 0!==t?t:[],this.analiticsCode=this.tagCtx.props.analiticsCode,this.width=this.tagCtx.props.width||!1,this.height=this.tagCtx.props.height||!1,this.swiper=null,this.container=null,this.displayMode=this.setDisplayMode(),this.createSlider=this.createSlider.bind(this),this.setDisplayMode=this.setDisplayMode.bind(this),this.updateSlider=this.updateSlider.bind(this)},async onAfterLink(){var t,e;const n=this;function i(t){var e,i;null===(i=null===(e=n.swiper)||void 0===e?void 0:e.autoplay)||void 0===i||i.start()}function s(t){var e,i;null===(i=null===(e=n.swiper)||void 0===e?void 0:e.autoplay)||void 0===i||i.stop()}null===(t=this.swiper)||void 0===t||t.destroy(),null===(e=this.observer)||void 0===e||e.destroy(),this.container=this.linkCtx.elem.querySelector(".swiper-container"),null!=this.container?(await this.ctx.root.$helper.nextTick(),this.swiper=this.createSlider(),window.addEventListener("resize",this.updateSlider),this.swiper.on("transitionStart",(()=>{if("d"===wb.settings.displayMode){const t=document.querySelector(".j-tooltip-advertising");t&&t.elemTarget.closest(".j-single-banner")&&t.close()}})),this.observer=function(){var t,e,a;const r=navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.indexOf("Trident/")>0;let o;r?i():(o=null===(t=n.ctx.root)||void 0===t?void 0:t.$observerHelper.getCarouselBannersObserver(n.container,{threshold:.5}),null===(e=n.container)||void 0===e||e.addEventListener(o.elementInViewportEventName,i),null===(a=n.container)||void 0===a||a.addEventListener(o.elementOutOfViewportEventName,s),o.observe());return{destroy:function(){var t,e;!r&&o&&(o.destroy(),null===(t=n.container)||void 0===t||t.removeEventListener(o.elementInViewportEventName,i),null===(e=n.container)||void 0===e||e.removeEventListener(o.elementOutOfViewportEventName,s))}}}()):this.swiper=null},onDispose(){var t;null===(t=this.swiper)||void 0===t||t.destroy(),window.removeEventListener("resize",this.updateSlider)},createSlider(){return new Swiper(this.container,{preloadImages:!1,loop:!0,lazy:{loadOnTransitionStart:!0,loadPrevNext:!0},autoplay:{delay:5e3},slidesPerView:"auto",navigation:{nextEl:".j-slider-banners-mini .swiper-button-next",prevEl:".j-slider-banners-mini .swiper-button-prev",disabledClass:"hide"},breakpoints:{1024:{loop:!1}},on:{click:t=>{const e=t.target.closest(".j-banner-click-stat");if(null!=e){const{data:t}=$.view(e);this.ctx.root.$stat.banners.sendClickStatistic($(e)),this.ctx.root.$analitic.saveState({l:this.tagCtx.props.analiticsCode,t:null==t?void 0:t.id,t2:parseInt(e.dataset.bannerIndex)+1})}}}})},setDisplayMode(){let t=1280-(window.innerWidth-document.documentElement.clientWidth);return document.documentElement.clientWidth>=t?"displayMode1":"displayMode2"},updateSlider(){var t;let e=this.setDisplayMode();this.displayMode!==e&&(this.displayMode=e,null===(t=this.swiper)||void 0===t||t.destroy(),this.swiper=this.createSlider())}},bannersCarouselNew:{template:'<div class="slider-main__list j-banners-wrapper-new">\n                {{for item}}\n                    {{singleBanner banner=#data bannerIndex=#getIndex() analiticsCode=~tag.analiticsCode itemClass=~tag.getItemClass(#getIndex()) width=~tag.width height=~tag.height /}}\n                {{/for}}\n            </div>',init(){var t;this.banners=null!==(t=this.tagCtx.props.banners)&&void 0!==t?t:[],this.analiticsCode=this.tagCtx.props.analiticsCode,this.width=this.tagCtx.props.width||!1,this.height=this.tagCtx.props.height||!1,this.carousel=new n,this.getItemClass=t=>"j-banners-carousel-item slider-main__slide"+(0===t?" active":""),this._startCarousel=this._startCarousel.bind(this)},async onAfterLink(){var t;this.container=null===(t=this.linkCtx)||void 0===t?void 0:t.elem.querySelector(".j-banners-wrapper-new"),null!=this.container&&(this._startCarousel(),$.observe(wb.settings,"displayType",this._startCarousel))},onDispose(){var t;null===(t=this.observer)||void 0===t||t.destroy(),this.carousel.stop(),$.unobserve(wb.settings,"displayType",this._startCarousel)},_setObserver(){const t=this;function e(e){e.target.classList.contains("j-banners-wrapper-new")&&t.carousel.start(e.target)}function n(e){e.target.classList.contains("j-banners-wrapper-new")&&t.carousel.stop()}this._stopSliding(),this.observer=function(){var i;const s=navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.indexOf("Trident/")>0;if(s)return;const a=null===(i=t.ctx.root)||void 0===i?void 0:i.$observerHelper.getCarouselBannersObserver(t.container,{threshold:.9});return t.container.addEventListener(a.elementInViewportEventName,e),t.container.addEventListener(a.elementOutOfViewportEventName,n),a.observe(),{destroy:function(){if(s||!a)return;a.destroy(),t.container.removeEventListener(a.elementInViewportEventName,e),t.container.removeEventListener(a.elementOutOfViewportEventName,n)}}}()},_stopSliding(){var t,e;null===(t=this.carousel)||void 0===t||t.stop(),null===(e=this.observer)||void 0===e||e.destroy(),this.observer=null},_startCarousel(){"phone"==wb.settings.displayType?this._stopSliding():this._setObserver()}},singleBanner:{template:'<div class="img-plug {{:~tagCtx.props.bannersZonesContainer || \'banners-zones-container\'}}{{if ~tagCtx.props.itemClass}}{{: \' \' + ~tagCtx.props.itemClass }}{{/if}}" data-plug-text="{{:~imgLoadError}}">\n                <div class="{{:~tagCtx.props.bannersZoneClass || \'banners-zones\'}}" data-link="{on ~tagCtx.props.protectAdult && ~tag.protectAdultGoods}">\n                    <a class="j-banner-shown-stat j-banner-click-stat j-banner-wba j-banner" data-link="{on ~root.$analitic.proceedAndSave ~tagCtx.props.analiticsCode null null ~tag.banner.id null #getIndex()+1 }class{merge: ~tag.banner.id == \'678f2be4-a2a5-4c13-9dbc-b84574c2c84a\' && ~wbSettings.walletTypeCode == 0 toggle=\'j-wallet-banner\'}" href="{{: ~tag.banner.link}}" title="{{attr: ~tag.banner.alt}}" target="{{: ~tag.banner.target || \'_blank\'}}" data-banner-id="{{: ~tag.banner.id}}" data-statistic-fields=\'{{:~toJson(~tag.banner.statisticFields)}}\' data-banner-index=\'{{:~tagCtx.props.bannerIndex}}\' data-analitics-code=\'{{:~tagCtx.props.analiticsCode}}\'>\n                        <div class="{{: ~tagCtx.props.imgContClass || \'img-wrap\'}}">\n                        {{if ~tagCtx.props.isLazy}}\n                            <img src="{{: ~wbSettings.staticSiteUrl}}/i/blank.gif" class="{{: ~tagCtx.props.imgClass || ""}}" name="{{: \'banner_\' + ~tag.banner.id}}" data-{{if ~tagCtx.props.swiperLazyLoad}}src{{else}}original{{/if}}="{{> ~tag.banner.absoluteUrl}}" alt="{{attr: ~tag.banner.alt}}" {{if !!~tag.banner.width && !!~tag.banner.height}}width="{{: ~tag.banner.width}}" height="{{: ~tag.banner.height}}"{{/if}} />\n                        {{else}}\n                            <img src="{{url: ~tag.banner.absoluteUrl}}" {{if ~tagCtx.props.isLazy === undefined}}loading="lazy"{{/if}} class="{{: ~tagCtx.props.imgClass || ""}}" name="{{: \'banner_\' + ~tag.banner.id}}"  alt="{{attr: ~tag.banner.alt}}" {{if !!~tag.banner.width && !!~tag.banner.height}}width="{{: ~tag.banner.width}}" height="{{: ~tag.banner.height}}"{{/if}} />\n                        {{/if}}\n                    \n                        {{btnAdvertising banner=~tag.banner /}}\n                        </div>\n                        \n                        {{if ~tagCtx.props.showPromoText && ~tagCtx.props.carousel}}\n                            {{for ~tag.banner.promoTextLines}}\n                                    <span class="item-info">{{>}}</span>\n                            {{/for}}\n                        {{/if}}\n                    </a>\n                </div>\n            </div>',init(){var t;this.banner=this.tagCtx.props.banner,this.banner.imgLoadError=this.ctx.root.$localziation.imgLoadError,this.banner.bannerSelections=(null!==(t=this.banner.bannerSelections)&&void 0!==t?t:[]).filter((t=>null!=t)),this.banner.bannerSelections.forEach((t=>{t.relativeYPos=100*t.relativeYPos+"%",t.relativeXPos=100*t.relativeXPos+"%",t.relativeWidth=100*t.relativeWidth+"%",t.relativeHeight=100*t.relativeHeight+"%"})),this.banner.width=this.tagCtx.props.width||!1,this.banner.height=this.tagCtx.props.height||!1},update(){},protectAdultGoods(t){const e=this.ctx.root;e.$adult.isConfirmed||(t.preventDefault(),e.$adult.proceedIfAdultConfirmed(!0,(()=>{var n;const i=null===(n=t.target.closest("a"))||void 0===n?void 0:n.href;null!=i&&e.$router.moveTo(i)}),e))}}})})();